#CV #segmentation 
## Что такое сегментация?
Сегментация - это по пиксельная классификация изображения, где мы ставим в соответсвие каждому пиксилю некоторый класс.

### Подзадачи:
- [[Semantic Segmentation]] - классическая попиксельная классификация изображения
- [[Instance Segmentation]] - выделение объектов внутри одного класса (сложнее)
- [[Panoptic Segmentation]] = Semantic + Instance. Комбинация двух методов идея которого заключается в разделение исчисляемых и неисчисляемых объектов - то есть некоторые сегментирую семантическии (неисчисляемые: земля, небо и т.д.), а некоторые как instance (исчисляемые: автомобили, велосипедисты, пешеходы и т.д.)

![[Pasted image 20230211195850.png]]

### Применение
- Беспилотники
- Медицина
- Аэрофотосъёмка
- Редактирование фото

## Обучение и оценка качества моделей

![[Pasted image 20230209190612.png|500]]

**Metrics**:
- [[PA & mPA|Pixel Accuracy (AC)]]
- [[PA & mPA|Mean Pixel Accuracy (MPA)]]
- [[Precision]]
- [[Recall]]
- [[F-score]]
- [[IoU]]
- [[Dice]] = F1 для бинарной классификации

**Losses**:
- BCE / [[Cross Entropy]]
- [[Dice]]
- [[Focal Loss]]
- [[Tversky Loss]]
- [[Focal Tversky Loss]]

## Архитектуры нейронных сетей
- SegNet - одна из первых архитектур.
- Unet - классический подход.
- [[DeepLabV3]] - продвинутый подход.

- Multiscale Prediction
	- [[Hierarchical Multi-scale Attention]]

## Особенности предобработки данных
- **Разметка**:
	- Делается в спец. тулах
	- Дороже разметки на классификацию
	- Можно пробовать размечать полуавтоматически. Давать нейронки разметить всё самой, а потом давать людям результат для доработки.

- **Препроцессинг**:
	- Если высокое разрешение сэмплево, то обучающий датасет разрезается на патчи.

- **Постпроцессинг и Инференс**: 
	- Чтобы улучшить качество, над предсказанными масками можно делать морфологические трансформации (есть в OpenCV)
	- ![[Pasted image 20230216220639.png|300]]
	- Использовать паддинг входного изображения, чтобы избежать рваных масок по краям
	- ![[Pasted image 20230216220714.png|300]]