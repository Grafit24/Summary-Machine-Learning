#CV #generation #gan 
[Источник](https://www.youtube.com/watch?v=N2u9lRXXRac)
## Generative adversarial networks
![[Pasted image 20220429234822.png]]
![[Pasted image 20230222191305.png]]
Генеративно-состязательная сеть, состоящая из **Генератора** и **Дескриминатора** 
Задача первого сгенерировать изображения, второго определить фейк оно или нет.

Обучение GAN заключается в максимизации мат. ожидания того, что модель распознает настоящие изображение от фейка, произведённый генератором. Обучение GAN это поиск точки равновесия между ошибкой определения фейков и их генерации. 

![[Pasted image 20220430000225.png]]

## Трюки обучения
1. **Малая норма градиента**
	- **Проблема**:
		- Дискриминатор быстро научился отличать
		- Небольшие изменения генератора не меняют ответа дискриминатора
		- Градиент дискриминатора близок к нулю
		- ![[Pasted image 20230303172115.png|300]]
	- **Решения**:
		- Изменить loss function:
			- [[MSE]], [[ReLU]], [[Wasserstein GAN|Earth Moving Distance]]
		- Упростить/регулиризировать дискриминатор
			- Чтобы не переобучался
		- Упростить оптимизатор дискриминатора
			- Пример. [[Adam]] $\rightarrow$ [[SGD]]
2. **Слабый дискриминатор**
	- **Проблема**:
		- Генератор научился всегда обманывать дискриминатор
		- Дискриминатор не в состоянии найти отличия
		- При всём этом низкое качество генерации
		- ![[Pasted image 20230303172817.png|300]]
	- **Решения**:
		- Усложнить дискриминатор
		- Добавить больше разных дискриминаторов 
			- Например, на отдельные области изображения
3. **Mode collapse** (генерируется одно и то же)
	- **Проблема**:
		- Генератор выдает реалистичные, но очень похожие данные
		- Дискриминатор классифицирует их как gt и ошибается на реальных данных
		- Лосс дискриминатора не очень большой, градиент тоже. Обучение останавливается
		- ![[Pasted image 20230303173503.png|300]]
	- **Решения**:
		- Использовать более умный loss
			- [[Wasserstein GAN|Earth mover's distance]]
4. **Долгая и немонотонная сходимость**
	- **Проблема**:
		- Дискриминатор быстро и сильно меняется
		- Генератор не успевает адаптироваться
		- Лосс то растет, то падает Сходимость затруднена
	- **Решения**:
		- [[Spectral Normalization]]. Использовать регуляризаторы для дискриминатора / генератора.
		- [[Feature Matching]]. Как бы заставляет модель делать так, чтобы фичи с фичи со сгенерированного изображдения были похожи на фичи с реального изображения. Дает более стабильный сигнал.
5. **Нереалистичная форма объектов**
	- **Проблема**:
		- Свертки хорошо анализируют локальные признаки
		- Текстуры генерируются хорошо
		- Форма теряется
	- **Решения**:
		- [[Self-Attention]]
		- ![[Pasted image 20230303174636.png]]

## Метрики
- [[Inception Score]]
- [[Frecht Inception Distance]]

## Архитектуры
- [[DCGAN]]
- [[CycleGAN]]
- [[Unsupervised domain adaptation]]
- [[Wasserstein GAN]]

**Полезные ссылки**:
- [GAN hacks](https://github.com/soumith/ganhacks)

Дальнейшее чтение:
- [Improved Techniques for Training GANs](https://arxiv.org/pdf/1606.03498v1.pdf)
- [BigGAN](https://arxiv.org/abs/1809.11096)